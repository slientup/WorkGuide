## 统一告警

#### 告警抑制
**功能：**
1. 当一段时间告警次数达到一定阈值就对其进行静默一段时间
2. 当静默时间到达后，再发送一次总的告警数。

**抑制分类：**

- 用户配置抑制：支持多个字段，实例和主题支持正则匹配，需用户配置。
- 默认抑制：只匹配实例和主题字段，且完全匹配，系统内部自身配置。

**抑制大体流程：**
1. 判断告警是否匹配用户配置的抑制规则，如果匹配走用户配置抑制流程
2. 如果不匹配，走默认的抑制规则流程

**用户配置的抑制规则流程：**
1. 判断用户是否匹配用户配置抑制规则，如果是，进入2
2. 当前告警是否已进入抑制阶段，如果进入抑制阶段，告知上层调用方该告警已抑制，流程结束
3. 否则进入告警抑制前统计阶段；统计告警计数，并判断是否满足抑制条件，满足就创建当前抑制对象。

默认的抑制规则与用户配置的抑制规则流程抑制一样。


**通知模块：**
告警发送模块主要做三件事
1. 告警接收人
2. 接收方式
3. 调用各个通知模块api发送告警

**接收人**

- 每一个实例在cmdb里面都有对应的owner信息，如果有人员离职，需要更新cmdb里面对应的owner信息，如果cmdb里面找不到owner，就发送到对应分类里面的所有人(这是默认规则)
- 是否有额外告警人需求：保留字段给用户,用户自己发送过来的告警携带保留字段，或者新增一个模块
**接收方式**
- 只根据告警级别来实现，用户如果想有特殊需求，可调整发送出来的告警级别来达到调整接收方式的目的。
**通知模块发送告警**
- 异步发送，需保证某个第三方接口异常不影响其他方式通知。
